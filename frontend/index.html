<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GameTrend Radar</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0a0f14;
      color: white;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .button {
      background: #007acc;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
    }

    .button:disabled {
      background: #666;
      cursor: not-allowed;
    }

    .error {
      background: #ff4444;
      color: white;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
    }

    .success {
      background: #44ff44;
      color: black;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <!-- åŠ è½½Reactå’ŒReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <script>
    // æœ€ç®€å•çš„Reactç»„ä»¶
    function App() {
      const [message, setMessage] = React.useState('é¡µé¢åŠ è½½ä¸­...');
      const [loading, setLoading] = React.useState(false);
      const [error, setError] = React.useState(null);

      // æµ‹è¯•APIè¿æ¥
      const testApiConnection = async () => {
        setLoading(true);
        setError(null);

        try {
          const response = await fetch('/api/games');
          if (response.ok) {
            setMessage('âœ… APIè¿æ¥æˆåŠŸï¼');
          } else {
            setMessage('âŒ APIè¿æ¥å¤±è´¥');
            setError(`HTTPé”™è¯¯: ${response.status}`);
          }
        } catch (err) {
          setMessage('âŒ APIè¿æ¥å‡ºé”™');
          setError(err.message);
        }

        setLoading(false);
      };

      // æ‰§è¡Œå®Œæ•´æ£€æµ‹
      const runFullCheck = async () => {
        setLoading(true);
        setError(null);

        try {
          const response = await fetch('/api/daily-job', { method: 'POST' });
          if (response.ok) {
            setMessage('âœ… å®Œæ•´æ£€æµ‹æ‰§è¡ŒæˆåŠŸï¼');
          } else {
            setMessage('âŒ å®Œæ•´æ£€æµ‹æ‰§è¡Œå¤±è´¥');
            setError(`HTTPé”™è¯¯: ${response.status}`);
          }
        } catch (err) {
          setMessage('âŒ å®Œæ•´æ£€æµ‹å‡ºé”™');
          setError(err.message);
        }

        setLoading(false);
      };

      // ç»„ä»¶åŠ è½½æ—¶æµ‹è¯•API
      React.useEffect(() => {
        testApiConnection();
      }, []);

      // æ¸²æŸ“ç®€å•çš„ç•Œé¢
      return React.createElement('div', {
        style: {
          minHeight: '100vh',
          background: '#0a0f14',
          color: 'white',
          padding: '20px'
        }
      }, [
        React.createElement('div', {
          key: 'header',
          style: { textAlign: 'center', marginBottom: '30px' }
        }, [
          React.createElement('h1', {
            key: 'title',
            style: { fontSize: '2rem', marginBottom: '10px' }
          }, 'ğŸ® GameTrend Radar'),
          React.createElement('p', {
            key: 'subtitle',
            style: { color: '#aaa', fontSize: '1rem' }
          }, 'HTML5 æ¸¸æˆè¶‹åŠ¿æ£€æµ‹å·¥å…·')
        ]),

        React.createElement('div', {
          key: 'content',
          style: { maxWidth: '600px', margin: '0 auto' }
        }, [
          React.createElement('div', {
            key: 'status',
            style: {
              background: '#1a2332',
              padding: '20px',
              borderRadius: '10px',
              marginBottom: '20px',
              textAlign: 'center'
            }
          }, [
            React.createElement('h2', {
              key: 'status-title',
              style: { marginBottom: '15px' }
            }, 'ç³»ç»ŸçŠ¶æ€'),
            React.createElement('p', {
              key: 'message',
              style: { fontSize: '1.2rem', fontWeight: 'bold' }
            }, message)
          ]),

          error && React.createElement('div', {
            key: 'error',
            style: {
              background: '#ff4444',
              color: 'white',
              padding: '10px',
              borderRadius: '5px',
              marginBottom: '20px'
            }
          }, `é”™è¯¯ä¿¡æ¯: ${error}`),

          React.createElement('div', {
            key: 'buttons',
            style: { display: 'flex', gap: '10px', justifyContent: 'center' }
          }, [
            React.createElement('button', {
              key: 'test-api',
              onClick: testApiConnection,
              disabled: loading,
              style: {
                background: '#007acc',
                color: 'white',
                border: 'none',
                padding: '10px 20px',
                borderRadius: '5px',
                cursor: 'pointer'
              }
            }, 'æµ‹è¯•APIè¿æ¥'),

            React.createElement('button', {
              key: 'run-check',
              onClick: runFullCheck,
              disabled: loading,
              style: {
                background: '#28a745',
                color: 'white',
                border: 'none',
                padding: '10px 20px',
                borderRadius: '5px',
                cursor: 'pointer'
              }
            }, loading ? 'æ‰§è¡Œä¸­...' : 'æ‰§è¡Œå®Œæ•´æ£€æµ‹')
          ])
        ])
      ]);
    }

    // æ¸²æŸ“ç»„ä»¶ï¼Œå¹¶æ·»åŠ é”™è¯¯å¤„ç†
    try {
      const root = document.getElementById('root');
      if (root) {
        ReactDOM.createRoot(root).render(React.createElement(App));
      } else {
        document.body.innerHTML = '<div style="color: red; padding: 20px;">é”™è¯¯: æ‰¾ä¸åˆ°æ ¹å…ƒç´  #root</div>';
      }
    } catch (error) {
      document.body.innerHTML = '<div style="color: red; padding: 20px;">Reactæ¸²æŸ“é”™è¯¯: ' + error.message + '</div>';
    }
  </script>
</body>

</html>